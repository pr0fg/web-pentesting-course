Lab 3 Solutions
======


### Challenge 1
The web service on port 8080 is running a CMS software called `Online Book Store 1.0`. This CMS is affected by a SQL injection vulnerability via the `bookisbn` HTTP GET parameter. 


### Challenge 2
The web service on port 8080 is running a CMS software called `Online Book Store 1.0`. This CMS is affected by a arbitrary file upload vulnerability via the `edit_book.php` PHP script.


### Challenge 3
The web service on port 8080 is running a CMS software called `Online Book Store 1.0`. This CMS is affected by an unauthenticated remote code execution vulnerability that allows an attacker to upload a malicious PHP script to `/bootstrap/img/`.


### Challenge 4
The web service on port 8081 is running a CMS software called `Online Course Registration 2.0`. This CMS is affected by a SQL injection vulnerability that can lead to remote code execution.

The login page for the CMS can be bypassed using the following username and password:

Username: `' or '1'='1'#`
Password: `' or '1'='1'#` 

After logging in and browsing to `MY PROFILE`, we can see the student's registration number is `10806121`.


### Challenge 5
After visiting the resource `/couponLookup.php`, you'll notice the PHP script is complaining about a missing cookie parameter called `couponName`. To send a request including this parameter, we can try doing:

```bash
curl -s -b "couponName=1" http://container-ip:8080/couponLookup.php
```

Doing so triggers the application to look up the coupon code, ultimately causing an error message that notes that valid `couponName` values should look like `BELL25`.

Following this logic, we can take a list of top 1000 English words, save them in a file called `1-1000.txt` and write a script to automatically identify valid coupon codes. Since the numeric value at the end of the coupon code is likely in increments of 5 or 10 (i.e. it's unlikely there's a discount of 17%), we can iterate only through valid numbers when brute forcing.

An example solution is as follows:
```bash
wget https://gist.githubusercontent.com/deekayen/4148741/raw/98d35708fa344717d8eee15d11987de6c8e26d7d/1-1000.txt

for w in `cat 1-1000.txt | tr '[:lower:]' '[:upper:]'`; do
	for ((n=5;n<=100;n+=5)); do 
		coupon="$w$n"
		curl -s -b "couponName=$coupon" http://container-ip:8080/couponLookup.php | grep -q Invalid || echo "$coupon"
	done
done
```
of which yields the coupon code `SPRING10`. To receive the flag, we can do:
```bash
curl -s -b "couponName=SPRING10" http://container-ip:8080/couponLookup.php
```

### Challenge 6
Joomla! is running on port 8082. Visit the URL `http://container-ip:8082/README.txt` to access view the version of Joomla! that's currently deployed (`3.4`). 

It may also be possible to identify the Joomla! version by using a tool like `joomscan`. 