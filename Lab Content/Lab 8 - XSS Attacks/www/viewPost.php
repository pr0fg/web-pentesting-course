<?php

include 'header.php';
include 'db.php';

$title = 'Loading...';
$username = '';
$content = '';

if(!empty($_REQUEST) && isset($_REQUEST['i']) && !empty($_REQUEST['i'])) {

    $stmt = $dbh->prepare("SELECT title, content, users.username FROM posts JOIN users ON posts.user_id=users.id WHERE posts.id=? LIMIT 1");

    if ($stmt->execute(array($_REQUEST['i']))) {
        if($row = $stmt->fetch()) {
            $title = $row['title'];
            $content = $row['content'];
            $username = $row['username'];
        }
        else {
            header("Location: /error.php?message=Invalid%20Post%20ID");
            die();
        }
    }
}

?>

<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <title>View Forum Post</title>
</head>
<body>
    <h2><?= $title ?></h2>
    <b>Published by: </b><?= $username ?><br/><br/>
    <div style="width: 80%"><?= $content ?></div>
    <br/>
    <input type="button" onclick="window.location.href = '/';" value="Back"/>
</body>
</html>