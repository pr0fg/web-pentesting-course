<?php 

function exception_error_handler($errno, $errstr, $errfile, $errline ) {
    throw new ErrorException($errstr, $errno, 0, $errfile, $errline);
}
set_error_handler("exception_error_handler");

if(!isset($_REQUEST['person'])) {
    header( 'Location:?person=gandhi');
    exit;
}

?>

<!DOCTYPE html>
<html>
<body>
    <h1>Quote of the Day</h1>
    <div>
        <?php

            if(strpos($_REQUEST['person'], 'passwd') == false) {
                try {
                    include('quotes/' . $_REQUEST['person']);
                } catch (ErrorException $ex) {
                    echo 'Hint: try to read /etc/passwd ;)';
                }
            }
            else if(preg_match('/^(..\/){10,}etc\/passwd$/', $_REQUEST['person'])) {
                echo 'Challenge 3 complete! Flag: 3f90afcd6c84ca0d048e4e66b587b8eb<br/><br/>';
                include($_REQUEST['person']);
            }
            else {
                echo 'Try harder!';
            }  
            
        ?>
    </div>
</body>
</html>