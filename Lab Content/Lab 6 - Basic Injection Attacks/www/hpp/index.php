<?php

$response = "";

if (isset($_REQUEST['From']) and isset($_REQUEST['To']) and isset($_REQUEST['Amount'])) {

    $from = $_REQUEST['From'];
    $to = $_REQUEST['To'];
    $amount = floatval($_REQUEST['Amount']);

    if ($from != '1KFHE7w8BhaENAswwryaoccDb6qcT6DbYY') {
         $response = '<b>Debug Message: </b>Invalid source account ID';
    }
    else if ($to != '3HqH1qGAqNWPpbrvyGjnRxNEjcUKD4e6ea') {
        $response = '<b>Debug Message: </b>Invalid recipient account ID';
    }
    else if ($amount <= 0 || $amount > 12.58823246) {
        $response = '<b>Debug Message: </b>Invalid amount';
    }
    else {
        if(isset($_REQUEST['Action']) && $_REQUEST['Action'] == 'withdraw') {
            $response = '<b>Debug Message: </b>Challenge 5 complete! Flag: 5fd1b7e27454f31ccb7e08d4344c75c1';
        }
        else {
            $response = "<b>Debug Message: </b>Queuing Action From account '$from' To account '$to' for Amount '$amount'" ;
        }
    }
}

?>

<!DOCTYPE html>
<html>
<body>
    <h1>Bitcoin Transfer System</h1>

    <p><b>Notice: </b>Withdraws have been suspended until we are liquid again (RIP you)!</p>

    <h3>Current Balance(s):</h3>
    Wallet: 1KFHE7w8BhaENAswwryaoccDb6qcT6DbYY&nbsp;&nbsp;&nbsp;&nbsp;Amount: 12.58823246 BTC<br/>
    Wallet: 3HqH1qGAqNWPpbrvyGjnRxNEjcUKD4e6ea&nbsp;&nbsp;&nbsp;&nbsp;Amount: 0 BTC
    <br/>
    
    <h3>Transfer Funds Between Accounts:</h3>
    <form name="transfer" action="" method="post">
        From Account: <input type="text" name="From" value="1KFHE7w8BhaENAswwryaoccDb6qcT6DbYY" size="50"><br/>
        To Account: <input type="text" name="To" size="50"><br/>
        Amount: <input type="text" name="Amount" size="10"><br/><br/>
        <input type="submit" name="Submit" value="Submit">
    </form>

    <p><?php echo "$response"; ?></p>

</body>
</html>
