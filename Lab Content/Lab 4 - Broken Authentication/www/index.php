<?php

  $errorMsg = "";

  if(isset($_COOKIE["UserID"]) && $_COOKIE['UserID'] == 189) {
     echo "Challenge 2 complete! Flag: 2a389eaee701671d049cee13a3ee8f5e";
     die();
  }

  if(isset($_POST["login"])) {
    if(isset($_COOKIE['StudentID']) && isset($_POST['username']) && isset($_POST['password']) && $_POST['username'] == $_COOKIE['StudentID'] && $_POST['password'] == "L1L0A0") {
      echo "Challenge 6 complete! Flag: 62523184264fadb7e2bfd5e358aa26b5";
      die();
    }
    elseif($_POST["username"] == "test" && $_POST["password"] == "test") {
      setcookie('UserID', "101", time() + (86400 * 30), "/");
      echo "Challenge 1 complete! Flag: 105f2165a3544247b06808c773e3ec4f";
      die();
    }
    elseif($_POST["username"] == "aldo" && $_POST["password"] == "trustno1") {
      setcookie('UserID', "102", time() + (86400 * 30), "/");
      echo "Challenge 4 complete! Flag: 4fc3660bdf4a132e3c19ece4f65102a2";
      die();
    }
    else {
      $errorMsg = "Invalid username or password.";
    }
  }

?>
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <title>Login</title>
</head>
<body>
  <form name="input" action="" method="post">
    <label for="username">Username:</label><input type="text" value="" id="username" name="username" /><br/>
    <label for="password">Password:</label><input type="password" value="" id="password" name="password" /><br/>
    <input type="submit" value="Login" name="login" />
    <input type="button" onclick="window.location.href = '/forgot.php';" value="Forgot Password"/><br/>
    <input type="button" onclick="window.location.href = '/register.php';" value="User Register"/>
    <input type="button" onclick="window.location.href = '/studentregister.php';" value="Student Register"/>
  </form>
  <div class="error"><font color="red"><?= $errorMsg ?></font></div>
</body>
</html>