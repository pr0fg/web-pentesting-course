<?php

include 'header.php';

$title = 'Loading...';
$content = '';

if(!empty($_REQUEST) && isset($_REQUEST['i']) && !empty($_REQUEST['i']) && strpos($_REQUEST['i'], '9238823') === false) {

    include 'db.php';

    $id = $_REQUEST['i'];

    $result = $mysqli->query("SELECT * FROM posts WHERE id=$id");
    if(!$result) {
        die("MySQL query failed: (" . $mysqli->errno . ") " . $mysqli->error);
    }

    if($result->num_rows > 0) {
        $row = $result->fetch_assoc();
        $title = $row['title'];
        $content = $row['content'];

        if(strpos(strtolower($title), '5.7.28') !== false || strpos(strtolower($content), '5.7.28') !== false) {
            echo 'Challenge 3 complete! Flag: 3e40f30d9e30dff7f1b20f8bee7d5c8c';
        }
    }
}

?>

<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <title>View Post</title>
</head>
<body>
    <h2><?= $title ?></h2>
    <pre><?= $content ?></pre>
    <br/>
    <input type="button" onclick="window.location.href = '/';" value="Back"/>
</body>
</html>