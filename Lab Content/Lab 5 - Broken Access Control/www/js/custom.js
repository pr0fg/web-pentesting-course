$(document).ready(function() {
	getPosts();
	getMessages();
});


function getPosts() {

	xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
	  if (this.readyState == 4 && this.status == 200) {
	    response=JSON.parse(this.responseText);
	    var content = '<table><tr><th>Title</th><th>View</th></tr>';
	    for(var i = 0; i < response.length; i++) {
    		var obj = response[i];
			content += '<tr><td>' + obj.title + '</td><td><a href="/viewPost.php?i=' + obj.id + '">View Post</a>';
		}
		content += '</table>';
		document.getElementById("posts").innerHTML = content;
	  }
	};
	xmlhttp.open("GET", "/api/posts/released.php", true);
	xmlhttp.send(); 
}


function getMessages() {

	xmlhttp = new XMLHttpRequest();
	xmlhttp.onreadystatechange = function() {
	  if (this.readyState == 4 && this.status == 200) {
	    response=JSON.parse(this.responseText);
	    var content = '<table><tr><th>From</th><th>Message</th></tr>';
	    for(var i = 0; i < response.length; i++) {
    		var obj = response[i];
    		content += '<tr><td>' + obj.from + '</td><td>' + obj.message + '</td></tr>';
		}
		content += '</table>';
		document.getElementById("messages").innerHTML = content;
	  }
	};
	xmlhttp.open("GET", "/api/user/messages.php", true);
	xmlhttp.send(); 
}